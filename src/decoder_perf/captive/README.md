The following files are taking, only slightly modified, from the Captive project
